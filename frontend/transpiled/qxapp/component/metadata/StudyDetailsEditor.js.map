{
  "version": 3,
  "sources": [
    "/home/travis/build/ITISFoundation/osparc-simcore/services/web/client/source/class/qxapp/component/metadata/StudyDetailsEditor.js"
  ],
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Class",
    "define",
    "extend",
    "ui",
    "core",
    "Widget",
    "construct",
    "study",
    "isTemplate",
    "_setLayout",
    "layout",
    "Grow",
    "__model",
    "data",
    "marshal",
    "Json",
    "createModel",
    "__stack",
    "container",
    "Stack",
    "__displayView",
    "__createDisplayView",
    "__editView",
    "__createEditView",
    "add",
    "_add",
    "__isTemplate",
    "__workbench",
    "workbench",
    "events",
    "updatedStudy",
    "updatedTemplate",
    "closed",
    "openedStudy",
    "properties",
    "mode",
    "check",
    "init",
    "nullable",
    "apply",
    "members",
    "__fields",
    "displayView",
    "Composite",
    "VBox",
    "__createButtons",
    "qxapp",
    "component",
    "metadata",
    "StudyDetails",
    "flex",
    "isCurrentUserOwner",
    "__isCurrentUserOwner",
    "canCreateTemplate",
    "Permissions",
    "getInstance",
    "canDo",
    "canUpdateTemplate",
    "buttonsLayout",
    "HBox",
    "set",
    "alignY",
    "marginTop",
    "openButton",
    "form",
    "Button",
    "appearance",
    "utils",
    "Utils",
    "setIdToWidget",
    "addListener",
    "fireEvent",
    "modeButton",
    "visibility",
    "setMode",
    "Spacer",
    "saveAsTemplateButton",
    "tr",
    "e",
    "btn",
    "getTarget",
    "setIcon",
    "getChildControl",
    "getContentElement",
    "addClass",
    "__saveAsTemplate",
    "fieldIsEnabled",
    "editView",
    "buttons",
    "alignX",
    "name",
    "TextField",
    "getName",
    "font",
    "height",
    "enabled",
    "description",
    "TextArea",
    "getDescription",
    "autoSize",
    "minHeight",
    "maxHeight",
    "thumbnail",
    "getThumbnail",
    "__saveStudy",
    "cancelButton",
    "basic",
    "Label",
    "apiCall",
    "io",
    "rest",
    "ResourceFactory",
    "createStudyResources",
    "project",
    "addListenerOnce",
    "resetIcon",
    "removeClass",
    "fireDataEvent",
    "getData",
    "console",
    "error",
    "message",
    "FlashMessenger",
    "logAs",
    "put",
    "getUuid",
    "__serializeForm",
    "projects",
    "postSaveAsTemplate",
    "util",
    "Serializer",
    "toNativeObject",
    "key",
    "getValue",
    "forEach",
    "fieldKey",
    "dirty",
    "clean",
    "wrapper",
    "DOMPurify",
    "sanitize",
    "_applyMode",
    "setSelection",
    "getPrjOwner",
    "getLogin",
    "StudyDetailsEditor"
  ],
  "mappings": "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",
  "sourcesContent": [
    "/*\n * oSPARC - The SIMCORE frontend - https://osparc.io\n * Copyright: 2019 IT'IS Foundation - https://itis.swiss\n * License: MIT - https://opensource.org/licenses/MIT\n * Authors: Ignacio Pascual (ignapas)\n *          Odei Maiz (odeimaiz)\n */\n\n/**\n * Widget that contains a stack with a StudyDetails and Study Details Editor form.\n *\n * It also provides options for opening the study and creating a template out of it if the\n * user has the permissios.\n *\n * *Example*\n *\n * Here is a little example of how to use the widget.\n *\n * <pre class='javascript'>\n *    const serviceInfo = new qxapp.component.metadata.ServiceInfo(selectedService);\n *    this.add(serviceInfo);\n * </pre>\n */\n\nqx.Class.define(\"qxapp.component.metadata.StudyDetailsEditor\", {\n  extend: qx.ui.core.Widget,\n\n  /**\n    * @param study {Object|qxapp.data.model.Study} Study (metadata)\n    * @param isTemplate {Boolean} Weather the study is template or not\n    */\n  construct: function(study, isTemplate) {\n    this.base(arguments);\n    this._setLayout(new qx.ui.layout.Grow());\n\n    this.__model = qx.data.marshal.Json.createModel(study);\n\n    this.__stack = new qx.ui.container.Stack();\n    this.__displayView = this.__createDisplayView(study);\n    this.__editView = this.__createEditView();\n    this.__stack.add(this.__displayView);\n    this.__stack.add(this.__editView);\n    this._add(this.__stack);\n\n    this.__isTemplate = isTemplate;\n\n    // Workaround: qx serializer is not doing well with uuid as object keys.\n    this.__workbench = study.workbench;\n  },\n\n  events: {\n    updatedStudy: \"qx.event.type.Data\",\n    updatedTemplate: \"qx.event.type.Data\",\n    closed: \"qx.event.type.Event\",\n    openedStudy: \"qx.event.type.Event\"\n  },\n\n  properties: {\n    mode: {\n      check: [\"display\", \"edit\"],\n      init: \"display\",\n      nullable: false,\n      apply: \"_applyMode\"\n    }\n  },\n\n  members: {\n    __stack: null,\n    __workbench: null,\n    __model: null,\n    __isTemplate: null,\n    __fields: null,\n\n    __createDisplayView: function(study) {\n      const displayView = new qx.ui.container.Composite(new qx.ui.layout.VBox(10));\n      displayView.add(this.__createButtons());\n      displayView.add(new qxapp.component.metadata.StudyDetails(study), {\n        flex: 1\n      });\n      return displayView;\n    },\n\n    __createButtons: function() {\n      const isCurrentUserOwner = this.__isCurrentUserOwner();\n      const canCreateTemplate = qxapp.data.Permissions.getInstance().canDo(\"studies.template.create\");\n      const canUpdateTemplate = qxapp.data.Permissions.getInstance().canDo(\"studies.template.update\");\n\n      const buttonsLayout = new qx.ui.container.Composite(new qx.ui.layout.HBox(8).set({\n        alignY: \"middle\"\n      })).set({\n        marginTop: 10\n      });\n\n      const openButton = new qx.ui.form.Button(\"Open\").set({\n        appearance: \"md-button\"\n      });\n      qxapp.utils.Utils.setIdToWidget(openButton, \"openStudyBtn\");\n      openButton.addListener(\"execute\", () => this.fireEvent(\"openedStudy\"), this);\n      buttonsLayout.add(openButton);\n\n      const modeButton = new qx.ui.form.Button(\"Edit\", \"@FontAwesome5Solid/edit/16\").set({\n        appearance: \"md-button\",\n        visibility: isCurrentUserOwner && (!this.__isTemplate || canUpdateTemplate) ? \"visible\" : \"excluded\"\n      });\n      qxapp.utils.Utils.setIdToWidget(modeButton, \"editStudyBtn\");\n      modeButton.addListener(\"execute\", () => this.setMode(\"edit\"), this);\n      buttonsLayout.add(modeButton);\n\n      buttonsLayout.add(new qx.ui.core.Spacer(), {\n        flex: 1\n      });\n\n      if (isCurrentUserOwner && (!this.__isTemplate && canCreateTemplate)) {\n        const saveAsTemplateButton = new qx.ui.form.Button(this.tr(\"Save as template\")).set({\n          appearance: \"md-button\"\n        });\n        qxapp.utils.Utils.setIdToWidget(saveAsTemplateButton, \"saveAsTemplateBtn\");\n        saveAsTemplateButton.addListener(\"execute\", e => {\n          const btn = e.getTarget();\n          btn.setIcon(\"@FontAwesome5Solid/circle-notch/12\");\n          btn.getChildControl(\"icon\").getContentElement()\n            .addClass(\"rotate\");\n          this.__saveAsTemplate(btn);\n        }, this);\n        buttonsLayout.add(saveAsTemplateButton);\n      }\n\n      return buttonsLayout;\n    },\n\n    __createEditView: function() {\n      const isCurrentUserOwner = this.__isCurrentUserOwner();\n      const canUpdateTemplate = qxapp.data.Permissions.getInstance().canDo(\"studies.template.update\");\n      const fieldIsEnabled = isCurrentUserOwner && (!this.__isTemplate || canUpdateTemplate);\n\n      const editView = new qx.ui.container.Composite(new qx.ui.layout.VBox(8));\n      const buttons = new qx.ui.container.Composite(new qx.ui.layout.HBox(8).set({\n        alignX: \"right\"\n      }));\n\n      this.__fields = {\n        name: new qx.ui.form.TextField(this.__model.getName()).set({\n          font: \"title-18\",\n          height: 35,\n          enabled: fieldIsEnabled\n        }),\n        description: new qx.ui.form.TextArea(this.__model.getDescription()).set({\n          autoSize: true,\n          minHeight: 100,\n          maxHeight: 500,\n          enabled: fieldIsEnabled\n        }),\n        thumbnail: new qx.ui.form.TextField(this.__model.getThumbnail()).set({\n          enabled: fieldIsEnabled\n        })\n      };\n\n      const modeButton = new qx.ui.form.Button(\"Save\", \"@FontAwesome5Solid/save/16\").set({\n        appearance: \"md-button\"\n      });\n      qxapp.utils.Utils.setIdToWidget(modeButton, \"studyDetailsEditorSaveBtn\");\n      modeButton.addListener(\"execute\", e => {\n        const btn = e.getTarget();\n        btn.setIcon(\"@FontAwesome5Solid/circle-notch/16\");\n        btn.getChildControl(\"icon\").getContentElement()\n          .addClass(\"rotate\");\n        this.__saveStudy(btn);\n      }, this);\n      const cancelButton = new qx.ui.form.Button(this.tr(\"Cancel\")).set({\n        appearance: \"md-button\",\n        enabled: isCurrentUserOwner && (!this.__isTemplate || canUpdateTemplate)\n      });\n      qxapp.utils.Utils.setIdToWidget(cancelButton, \"studyDetailsEditorCancelBtn\");\n      cancelButton.addListener(\"execute\", () => this.setMode(\"display\"), this);\n\n      const {\n        name,\n        description,\n        thumbnail\n      } = this.__fields;\n      editView.add(new qx.ui.basic.Label(this.tr(\"Title\")).set({\n        font: \"text-14\",\n        marginTop: 20\n      }));\n      qxapp.utils.Utils.setIdToWidget(name, \"studyDetailsEditorTitleFld\");\n      editView.add(name);\n      editView.add(new qx.ui.basic.Label(this.tr(\"Description\")).set({\n        font: \"text-14\"\n      }));\n      qxapp.utils.Utils.setIdToWidget(description, \"studyDetailsEditorDescFld\");\n      editView.add(description);\n      editView.add(new qx.ui.basic.Label(this.tr(\"Thumbnail\")).set({\n        font: \"text-14\"\n      }));\n      qxapp.utils.Utils.setIdToWidget(thumbnail, \"studyDetailsEditorThumbFld\");\n      editView.add(thumbnail);\n      editView.add(buttons);\n\n      buttons.add(modeButton);\n      buttons.add(cancelButton);\n\n      return editView;\n    },\n\n    __saveStudy: function(btn) {\n      const apiCall = qxapp.io.rest.ResourceFactory.getInstance().createStudyResources().project;\n      apiCall.addListenerOnce(\"putSuccess\", e => {\n        btn.resetIcon();\n        btn.getChildControl(\"icon\").getContentElement()\n          .removeClass(\"rotate\");\n        this.fireDataEvent(this.__isTemplate ? \"updatedTemplate\" : \"updatedStudy\", e);\n        const data = e.getData().data;\n        this.__model.set(data);\n        this.setMode(\"display\");\n      }, this);\n      apiCall.addListenerOnce(\"putError\", e => {\n        btn.resetIcon();\n        btn.getChildControl(\"icon\").getContentElement()\n          .removeClass(\"rotate\");\n        console.error(e);\n        qxapp.component.message.FlashMessenger.getInstance().logAs(this.tr(\"There was an error while updating the information.\"), \"ERROR\");\n      }, this);\n      apiCall.put({\n        \"project_id\": this.__model.getUuid()\n      }, this.__serializeForm());\n    },\n\n    __saveAsTemplate: function(btn) {\n      const apiCall = qxapp.io.rest.ResourceFactory.getInstance().createStudyResources().projects;\n      apiCall.addListenerOnce(\"postSaveAsTemplateSuccess\", e => {\n        btn.resetIcon();\n        btn.getChildControl(\"icon\").getContentElement()\n          .removeClass(\"rotate\");\n        this.fireDataEvent(\"updatedTemplate\", e);\n        const data = e.getData().data;\n        this.__model.set(data);\n        this.setMode(\"display\");\n      }, this);\n      apiCall.addListenerOnce(\"postSaveAsTemplateError\", e => {\n        btn.resetIcon();\n        console.error(e);\n        qxapp.component.message.FlashMessenger.getInstance().logAs(this.tr(\"There was an error while saving as template.\"), \"ERROR\");\n      }, this);\n      apiCall.postSaveAsTemplate({\n        \"study_id\": this.__model.getUuid()\n      }, this.__serializeForm());\n    },\n\n    __serializeForm: function() {\n      const data = {\n        ...qx.util.Serializer.toNativeObject(this.__model),\n        workbench: this.__workbench\n      };\n      for (let key in this.__fields) {\n        data[key] = this.__fields[key].getValue();\n      }\n      // Protect text fields against injecting malicious html/code in them\n      [\n        \"name\",\n        \"description\",\n        \"thumbnail\"\n      ].forEach(fieldKey => {\n        const dirty = data[fieldKey];\n        const clean = qxapp.wrapper.DOMPurify.getInstance().sanitize(dirty);\n        if (dirty !== clean) {\n          qxapp.component.message.FlashMessenger.getInstance().logAs(this.tr(\"There was an issue in the text of \") + fieldKey, \"ERROR\");\n        }\n        data[fieldKey] = clean;\n      }, this);\n      return data;\n    },\n\n    _applyMode: function(mode) {\n      switch (mode) {\n        case \"display\":\n          this.__stack.setSelection([this.__displayView]);\n          break;\n        case \"edit\":\n          this.__stack.setSelection([this.__editView]);\n          break;\n      }\n    },\n\n    __isCurrentUserOwner: function() {\n      if (this.__model) {\n        return this.__model.getPrjOwner() === qxapp.data.Permissions.getInstance().getLogin();\n      }\n      return false;\n    }\n  }\n});\n"
  ]
}