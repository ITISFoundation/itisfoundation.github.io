{
  "version": 3,
  "sources": [
    "/home/travis/build/ITISFoundation/osparc-simcore/services/web/client/source/class/qxapp/component/filter/TagsFilter.js"
  ],
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Class",
    "define",
    "extend",
    "qxapp",
    "component",
    "filter",
    "UIFilter",
    "construct",
    "filterId",
    "groupId",
    "_setLayout",
    "ui",
    "layout",
    "HBox",
    "__dropDown",
    "toolbar",
    "MenuButton",
    "tr",
    "setMenu",
    "__buildMenu",
    "_add",
    "members",
    "__activeTags",
    "__tagButtons",
    "reset",
    "menuButtons",
    "getMenu",
    "getChildren",
    "child",
    "menu",
    "Button",
    "forEach",
    "button",
    "resetIcon",
    "length",
    "tagName",
    "_remove",
    "_filterChange",
    "Menu",
    "utils",
    "Services",
    "getTypes",
    "serviceType",
    "Utils",
    "capitalize",
    "addListener",
    "e",
    "__addTag",
    "getTarget",
    "add",
    "addSeparator",
    "getCategories",
    "serviceCategory",
    "menuButton",
    "includes",
    "__removeTag",
    "setIcon",
    "tagButton",
    "push",
    "splice",
    "indexOf",
    "TagsFilter"
  ],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;;;;AAAAA,EAAAA,EAAE,CAACC,SAAH,CAAaC,oBAAb,CAAkCC,aAAlC;;AAAA;;;;;;;;;;;;;;;;;AAiBA;;;AAGAH,EAAAA,EAAE,CAACI,KAAH,CAASC,MAAT,CAAgB,mCAAhB,EAAqD;AACnDC,IAAAA,MAAM,EAAEC,KAAK,CAACC,SAAN,CAAgBC,MAAhB,CAAuBC,QADoB;;AAGnD;;;;;AAKAC,IAAAA,SAAS,EAAE,mBAASC,QAAT,EAAmBC,OAAnB,EAA4B;AACrC,6DAAqBD,QAArB,EAA+BC,OAA/B;;AACA,WAAKC,UAAL,CAAgB,IAAId,EAAE,CAACe,EAAH,CAAMC,MAAN,CAAaC,IAAjB,EAAhB;;AAEA,WAAKC,UAAL,GAAkB,IAAIlB,EAAE,CAACe,EAAH,CAAMI,OAAN,CAAcC,UAAlB,CAA6B,KAAKC,EAAL,CAAQ,MAAR,CAA7B,CAAlB;;AACA,WAAKH,UAAL,CAAgBI,OAAhB,CAAwB,KAAKC,WAAL,EAAxB;;AACA,WAAKC,IAAL,CAAU,KAAKN,UAAf;AACD,KAfkD;AAiBnDO,IAAAA,OAAO,EAAE;AACPP,MAAAA,UAAU,EAAE,IADL;AAEPQ,MAAAA,YAAY,EAAE,IAFP;AAGPC,MAAAA,YAAY,EAAE,IAHP;;AAKP;;;AAGAC,MAAAA,KAAK,EAAE,iBAAW;AAChB;AACA,YAAMC,WAAW,GAAG,KAAKX,UAAL,CAAgBY,OAAhB,GAA0BC,WAA1B,GACjBtB,MADiB,CACV,UAAAuB,KAAK;AAAA,iBAAIA,KAAK,YAAYhC,EAAE,CAACe,EAAH,CAAMkB,IAAN,CAAWC,MAAhC;AAAA,SADK,CAApB;;AAEAL,QAAAA,WAAW,CAACM,OAAZ,CAAoB,UAAAC,MAAM;AAAA,iBAAIA,MAAM,CAACC,SAAP,EAAJ;AAAA,SAA1B,EAJgB,CAKhB;;AACA,YAAI,KAAKX,YAAL,IAAqB,KAAKA,YAAL,CAAkBY,MAA3C,EAAmD;AACjD,eAAKZ,YAAL,CAAkBY,MAAlB,GAA2B,CAA3B;AACD,SARe,CAShB;;;AACA,aAAK,IAAIC,OAAT,IAAoB,KAAKZ,YAAzB,EAAuC;AACrC,eAAKa,OAAL,CAAa,KAAKb,YAAL,CAAkBY,OAAlB,CAAb;;AACA,iBAAO,KAAKZ,YAAL,CAAkBY,OAAlB,CAAP;AACD,SAbe,CAchB;;;AACA,aAAKE,aAAL,CAAmB,KAAKf,YAAxB;AACD,OAxBM;AA0BPH,MAAAA,WAAW,EAAE,uBAAW;AAAA;;AACtB,YAAMU,IAAI,GAAG,IAAIjC,EAAE,CAACe,EAAH,CAAMkB,IAAN,CAAWS,IAAf,EAAb;AAEAnC,QAAAA,KAAK,CAACoC,KAAN,CAAYC,QAAZ,CAAqBC,QAArB,GAAgCV,OAAhC,CAAwC,UAAAW,WAAW,EAAI;AACrD,cAAMV,MAAM,GAAG,IAAIpC,EAAE,CAACe,EAAH,CAAMkB,IAAN,CAAWC,MAAf,CAAsB3B,KAAK,CAACoC,KAAN,CAAYI,KAAZ,CAAkBC,UAAlB,CAA6BF,WAA7B,CAAtB,CAAf;AACAV,UAAAA,MAAM,CAACa,WAAP,CAAmB,SAAnB,EAA8B,UAAAC,CAAC;AAAA,mBAAI,KAAI,CAACC,QAAL,CAAcL,WAAd,EAA2BI,CAAC,CAACE,SAAF,EAA3B,CAAJ;AAAA,WAA/B;AACAnB,UAAAA,IAAI,CAACoB,GAAL,CAASjB,MAAT;AACD,SAJD;AAMAH,QAAAA,IAAI,CAACqB,YAAL;AAEA/C,QAAAA,KAAK,CAACoC,KAAN,CAAYC,QAAZ,CAAqBW,aAArB,GAAqCpB,OAArC,CAA6C,UAAAqB,eAAe,EAAI;AAC9D,cAAMpB,MAAM,GAAG,IAAIpC,EAAE,CAACe,EAAH,CAAMkB,IAAN,CAAWC,MAAf,CAAsB3B,KAAK,CAACoC,KAAN,CAAYI,KAAZ,CAAkBC,UAAlB,CAA6BQ,eAA7B,CAAtB,CAAf;AACApB,UAAAA,MAAM,CAACa,WAAP,CAAmB,SAAnB,EAA8B,UAAAC,CAAC;AAAA,mBAAI,KAAI,CAACC,QAAL,CAAcK,eAAd,EAA+BN,CAAC,CAACE,SAAF,EAA/B,CAAJ;AAAA,WAA/B;AACAnB,UAAAA,IAAI,CAACoB,GAAL,CAASjB,MAAT;AACD,SAJD;AAKA,eAAOH,IAAP;AACD,OA3CM;AA6CPkB,MAAAA,QAAQ,EAAE,kBAASZ,OAAT,EAAkBkB,UAAlB,EAA8B;AAAA;;AACtC;AACA,aAAK/B,YAAL,GAAoB,KAAKA,YAAL,IAAqB,EAAzC;;AACA,YAAI,KAAKA,YAAL,CAAkBgC,QAAlB,CAA2BnB,OAA3B,CAAJ,EAAyC;AACvC,eAAKoB,WAAL,CAAiBpB,OAAjB,EAA0BkB,UAA1B;AACD,SAFD,MAEO;AACL;AACAA,UAAAA,UAAU,CAACG,OAAX,CAAmB,6BAAnB,EAFK,CAGL;;AACA,cAAMC,SAAS,GAAG,IAAI7D,EAAE,CAACe,EAAH,CAAMI,OAAN,CAAce,MAAlB,CAAyB3B,KAAK,CAACoC,KAAN,CAAYI,KAAZ,CAAkBC,UAAlB,CAA6BT,OAA7B,CAAzB,EAAgE,yBAAhE,CAAlB;;AACA,eAAKf,IAAL,CAAUqC,SAAV;;AACAA,UAAAA,SAAS,CAACZ,WAAV,CAAsB,SAAtB,EAAiC;AAAA,mBAAM,MAAI,CAACU,WAAL,CAAiBpB,OAAjB,EAA0BkB,UAA1B,CAAN;AAAA,WAAjC,EANK,CAOL;;AACA,eAAK/B,YAAL,CAAkBoC,IAAlB,CAAuBvB,OAAvB;;AACA,eAAKZ,YAAL,GAAoB,KAAKA,YAAL,IAAqB,EAAzC;AACA,eAAKA,YAAL,CAAkBY,OAAlB,IAA6BsB,SAA7B;AACD,SAhBqC,CAiBtC;;;AACA,aAAKpB,aAAL,CAAmB,KAAKf,YAAxB;AACD,OAhEM;AAkEPiC,MAAAA,WAAW,EAAE,qBAASpB,OAAT,EAAkBkB,UAAlB,EAA8B;AACzC;AACAA,QAAAA,UAAU,CAACpB,SAAX,GAFyC,CAGzC;;AACA,aAAKX,YAAL,CAAkBqC,MAAlB,CAAyB,KAAKrC,YAAL,CAAkBsC,OAAlB,CAA0BzB,OAA1B,CAAzB,EAA6D,CAA7D;;AACA,aAAKC,OAAL,CAAa,KAAKb,YAAL,CAAkBY,OAAlB,CAAb;;AACA,eAAO,KAAKZ,YAAL,CAAkBY,OAAlB,CAAP,CANyC,CAOzC;;AACA,aAAKE,aAAL,CAAmB,KAAKf,YAAxB;AACD;AA3EM;AAjB0C,GAArD;AApBAnB,EAAAA,KAAK,CAACC,SAAN,CAAgBC,MAAhB,CAAuBwD,UAAvB,CAAkC9D,aAAlC,GAAkDA,aAAlD",
  "sourcesContent": [
    "/* ************************************************************************\n\n   qxapp - the simcore frontend\n\n   https://osparc.io\n\n   Copyright:\n     2019 IT'IS Foundation, https://itis.swiss\n\n   License:\n     MIT: https://opensource.org/licenses/MIT\n\n   Authors:\n     * Ignacio Pascual (ignapas)\n\n************************************************************************ */\n\n/**\n * Dropdown menu for tag filtering\n */\nqx.Class.define(\"qxapp.component.filter.TagsFilter\", {\n  extend: qxapp.component.filter.UIFilter,\n\n  /**\n   * Constructor for TagsFilter creates a workbench TagsFilter.\n   *\n   * @extends qxapp.component.filter.UIFilter\n   */\n  construct: function(filterId, groupId) {\n    this.base(arguments, filterId, groupId);\n    this._setLayout(new qx.ui.layout.HBox());\n\n    this.__dropDown = new qx.ui.toolbar.MenuButton(this.tr(\"Tags\"));\n    this.__dropDown.setMenu(this.__buildMenu());\n    this._add(this.__dropDown);\n  },\n\n  members: {\n    __dropDown: null,\n    __activeTags: null,\n    __tagButtons: null,\n\n    /**\n     * Implementing IFilter: Function in charge of resetting the filter.\n     */\n    reset: function() {\n      // Remove ticks from menu\n      const menuButtons = this.__dropDown.getMenu().getChildren()\n        .filter(child => child instanceof qx.ui.menu.Button);\n      menuButtons.forEach(button => button.resetIcon());\n      // Remove active tags\n      if (this.__activeTags && this.__activeTags.length) {\n        this.__activeTags.length = 0;\n      }\n      // Remove tag buttons\n      for (let tagName in this.__tagButtons) {\n        this._remove(this.__tagButtons[tagName]);\n        delete this.__tagButtons[tagName];\n      }\n      // Dispatch\n      this._filterChange(this.__activeTags);\n    },\n\n    __buildMenu: function() {\n      const menu = new qx.ui.menu.Menu();\n\n      qxapp.utils.Services.getTypes().forEach(serviceType => {\n        const button = new qx.ui.menu.Button(qxapp.utils.Utils.capitalize(serviceType));\n        button.addListener(\"execute\", e => this.__addTag(serviceType, e.getTarget()));\n        menu.add(button);\n      });\n\n      menu.addSeparator();\n\n      qxapp.utils.Services.getCategories().forEach(serviceCategory => {\n        const button = new qx.ui.menu.Button(qxapp.utils.Utils.capitalize(serviceCategory));\n        button.addListener(\"execute\", e => this.__addTag(serviceCategory, e.getTarget()));\n        menu.add(button);\n      });\n      return menu;\n    },\n\n    __addTag: function(tagName, menuButton) {\n      // Check if added\n      this.__activeTags = this.__activeTags || [];\n      if (this.__activeTags.includes(tagName)) {\n        this.__removeTag(tagName, menuButton);\n      } else {\n        // Add tick\n        menuButton.setIcon(\"@FontAwesome5Solid/check/12\");\n        // Add tag\n        const tagButton = new qx.ui.toolbar.Button(qxapp.utils.Utils.capitalize(tagName), \"@MaterialIcons/close/12\");\n        this._add(tagButton);\n        tagButton.addListener(\"execute\", () => this.__removeTag(tagName, menuButton));\n        // Update state\n        this.__activeTags.push(tagName);\n        this.__tagButtons = this.__tagButtons || {};\n        this.__tagButtons[tagName] = tagButton;\n      }\n      // Dispatch\n      this._filterChange(this.__activeTags);\n    },\n\n    __removeTag: function(tagName, menuButton) {\n      // Remove tick\n      menuButton.resetIcon();\n      // Update state\n      this.__activeTags.splice(this.__activeTags.indexOf(tagName), 1);\n      this._remove(this.__tagButtons[tagName]);\n      delete this.__tagButtons[tagName];\n      // Dispatch\n      this._filterChange(this.__activeTags);\n    }\n  }\n});\n"
  ]
}