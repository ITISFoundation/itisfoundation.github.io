{
  "version": 3,
  "sources": [
    "/home/travis/build/ITISFoundation/osparc-simcore/services/web/client/source/class/qxapp/desktop/MainPage.js"
  ],
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Class",
    "define",
    "extend",
    "ui",
    "core",
    "Widget",
    "construct",
    "studyId",
    "_setLayout",
    "layout",
    "VBox",
    "navBar",
    "__navBar",
    "__createNavigationBar",
    "_add",
    "prjStack",
    "__prjStack",
    "__createMainView",
    "flex",
    "qxapp",
    "io",
    "WatchDog",
    "getInstance",
    "startCheck",
    "events",
    "members",
    "__dashboard",
    "__studyEditor",
    "desktop",
    "NavigationBar",
    "set",
    "height",
    "addListener",
    "data",
    "Permissions",
    "canDo",
    "updateStudyDocument",
    "closeStudy",
    "__showDashboard",
    "e",
    "nodeId",
    "getData",
    "nodeSelected",
    "container",
    "Stack",
    "dashboard",
    "Dashboard",
    "getStudyBrowser",
    "studyEditor",
    "__showStudyEditor",
    "add",
    "setSelection",
    "reloadUserStudies",
    "setPathButtons",
    "destruct",
    "remove",
    "study",
    "getStudy",
    "setStudy",
    "getWorkbench",
    "getPathIds",
    "ev",
    "elements",
    "wasSaved",
    "studySaved",
    "MainPage"
  ],
  "mappings": "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",
  "sourcesContent": [
    "/* ************************************************************************\n\n   qxapp - the simcore frontend\n\n   https://osparc.io\n\n   Copyright:\n     2018 IT'IS Foundation, https://itis.swiss\n\n   License:\n     MIT: https://opensource.org/licenses/MIT\n\n   Authors:\n     * Odei Maiz (odeimaiz)\n\n************************************************************************ */\n\n/**\n * Widget managing the layout once the user is logged in.\n *\n * It offers a:\n * - NavigationBar\n * - Main View (Stack).\n *   - Dashboard (Stack):\n *     - StudyBrowser\n *     - ServiceBrowser\n *     - DataManager\n *   - StudyEditor\n *\n * <pre class='javascript'>\n *   let layoutManager = new qxapp.desktop.MainPage();\n *   this.getRoot().add(layoutManager);\n * </pre>\n */\n\nqx.Class.define(\"qxapp.desktop.MainPage\", {\n  extend: qx.ui.core.Widget,\n\n  construct: function(studyId) {\n    this.base();\n\n    this._setLayout(new qx.ui.layout.VBox());\n\n    let navBar = this.__navBar = this.__createNavigationBar();\n    this._add(navBar);\n\n    let prjStack = this.__prjStack = this.__createMainView(studyId);\n    this._add(prjStack, {\n      flex: 1\n    });\n\n    qxapp.io.WatchDog.getInstance().startCheck();\n  },\n\n  events: {},\n\n  members: {\n    __navBar: null,\n    __prjStack: null,\n    __dashboard: null,\n    __studyEditor: null,\n\n    __createNavigationBar: function() {\n      let navBar = new qxapp.desktop.NavigationBar().set({\n        height: 100\n      });\n\n      navBar.addListener(\"dashboardPressed\", () => {\n        if (!qxapp.data.Permissions.getInstance().canDo(\"studies.user.create\", true)) {\n          return;\n        }\n        if (this.__studyEditor) {\n          this.__studyEditor.updateStudyDocument();\n          this.__studyEditor.closeStudy();\n        }\n        this.__showDashboard();\n      }, this);\n\n      navBar.addListener(\"nodeDoubleClicked\", e => {\n        if (this.__studyEditor) {\n          let nodeId = e.getData();\n          this.__studyEditor.nodeSelected(nodeId, true);\n        }\n      }, this);\n      return navBar;\n    },\n\n    __createMainView: function(studyId) {\n      let prjStack = new qx.ui.container.Stack();\n\n      let dashboard = this.__dashboard = new qxapp.desktop.Dashboard(studyId);\n      dashboard.getStudyBrowser().addListener(\"startStudy\", e => {\n        const studyEditor = e.getData();\n        this.__showStudyEditor(studyEditor);\n      }, this);\n      prjStack.add(dashboard);\n\n      return prjStack;\n    },\n\n    __showDashboard: function() {\n      this.__prjStack.setSelection([this.__dashboard]);\n      this.__dashboard.getStudyBrowser().reloadUserStudies();\n      this.__navBar.setPathButtons([]);\n      if (this.__studyEditor) {\n        this.__studyEditor.destruct();\n      }\n    },\n\n    __showStudyEditor: function(studyEditor) {\n      if (this.__studyEditor) {\n        this.__prjStack.remove(this.__studyEditor);\n      }\n\n      this.__studyEditor = studyEditor;\n      let study = studyEditor.getStudy();\n      this.__prjStack.add(this.__studyEditor);\n      this.__prjStack.setSelection([this.__studyEditor]);\n      this.__navBar.setStudy(study);\n      this.__navBar.setPathButtons(study.getWorkbench().getPathIds(\"root\"));\n\n      this.__studyEditor.addListener(\"changeMainViewCaption\", ev => {\n        const elements = ev.getData();\n        this.__navBar.setPathButtons(elements);\n      }, this);\n\n      this.__studyEditor.addListener(\"studySaved\", ev => {\n        const wasSaved = ev.getData();\n        if (wasSaved) {\n          this.__navBar.studySaved();\n        }\n      }, this);\n    }\n  }\n});\n"
  ]
}